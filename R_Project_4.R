library(astsa)
n=length(varve)data.1=varve[1:(n/2)]data.2=varve[((n/2)+1):n]m1=mean(data.1)m2=mean(data.2)v1=var(data.1)v2=var(data.2)m1m2v1v2#Step 3: take natural log of two halves as follows:logvarve=log(varve)logdata.1=log(data.1)logdata.2=log(data.2)m3=mean(logdata.1)m4=mean(logdata.2)v3=var(logdata.1)v4=var(logdata.2)m3m4v3v4#Step4: make histogram and QQ-plot for original and transformed data.par(mfrow=c(2,2))hist(varve, main="Histogram of Original Series",freq=FALSE)qqnorm(varve,main="QQ-Plot of Original Data") qqline(varve)hist(logvarve, main="Histogram of log Series",freq=FALSE) qqnorm(logvarve,main="QQ-Plot of log Data") qqline(logvarve)#Step 5: Use acf() function to make ACF plot of transformed data.acf(logvarve, lag=100)#Step 6: Find differenced values for the log transfirmed data and plot these and their acf values.l.y<-diff(log(varve))par(mfrow=c(2,1))plot.ts(l.y,main="Differenced Yt",ylab="log(Y(t))-log(Y(t-1))")acf(l.y,main="ACF of differenced series",xlab="Lag",ylab="differenced Yt",lag=100) #2.11ts.plot(oil,gas,main="Plots of oil (dollar/barrel) and gas (cents/gallon)",xlab="time",ylab="price",col=(c("red",1)),lwd=2, lty=1)#log formyt.oil<-diff(log(oil)) yt.gas<-diff(log(gas)) ts.plot(yt.oil, yt.gas, main="Plots of logged oil (dollar/barrel) and gas (cents/gallon) price",xlab="time",ylab="logprice",col=(c("red",1)),lwd=2, lty=1)par(mfrow=c(2,2))acf(oil,lag=200, main="ACF of original oil data")acf(yt.oil,lag=200,main="ACF of logged oil data")acf(gas,lag=200,main="ACF of original gasdata")acf(yt.gas,lag=200,main="ACF of logged gas data")par(mfrow=c(1,2))ccf(oil, gas,lag=200, main="CCF of original data")ccf(yt.oil,yt.gas,lag=200, main="CCF of transformed data")#2.12ksmooth(time(gtemp),gtemp,"normal",bandwidth=5)For plotting: plot(gtemp,main="Global Temp. Deviations: Kernel Smoothing",sub="bandwidth=5 and bandwidth=2") lines(ksmooth(time(gtemp),gtemp,"normal",bandwidth=5),col="red",lwd=2,lty=2) lines(ksmooth(time(gtemp),gtemp,"normal",bandwidth=2),col="blue",lwd=2,lty=1) 