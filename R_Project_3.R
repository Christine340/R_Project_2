Winedata=read.table("Winedata.R")Red=Winedata$RedRose=Winedata$Rosex=Redx1=Roseplot.ts(x,main="Red Wines Sales",ylab="Xt")plot.ts(log(x),main="Log Transformation of Red Wines Data",xlab="t",ylab="Yt")par(mfrow=c(1,2))acf(x,lag=100,main="ACF of Red Wines")x2=log(x)acf(x2,lag=100,main="ACF of transfored Red Wines")Problem6install.packages("astsa")library(astsa)plot(tempr,main="Temperature",xlab="Time",ylab="temp")x=temprx=x-mean(x)n=length(x)I=abs(fft(x)^2)/nhalf=floor((n)/2-1)f=0:half/nP=(4/n)*I[1:(n/2)]plot(f,P,type="l",main="Periodogram for Temperature",ylab="P(frequency)",xlab="frequency",col="blue")index=which(P==max(P))w=1/f[index]f[index]install.packages("astsa")library(astsa)###linearY<-jjt<-time(jj)fit1=lm(Y~t)summary(fit1)anova(fit1)plot(jj,type="o",xlab="Time",ylab="Johnson&Johnson",main="Johnson and Johnson Linear Fit",col="darkgreen")abline(fit1,col="red",lwd=2)###quadratic modeltsq=t^2/factorial(2)fit2=lm(Y~t+tsq)summary(fit2)anova(fit2)plot(jj,type="o",xlab="Time(year)",ylab="Johnson&Johnson",main="Johnson and Johnson Quadratic Fit")par(new=T)plot(fit2$fitted,col="red",lwd=2,type="l",ylab="",xlab="",main="",xaxt="n",yaxt="n")## partcX.all<-jj[1:84]t<-time(jj)values<-length(t)-15ts<-t[1:values]X<-X.all[1:values]year.first<-values+1year.last<-length(t)new<-data.frame(ts=t[year.first:year.last])X.true<-X.all[(values+1):length(t)]fit1<-lm(X~ts)Xhat<-predict(fit1,new,se.fit=TRUE)X.hat<-round(Xhat$fit,2)error<-X.true-X.hatme=mean(error)mpe=100*(mean(error/X.true)) mse=sum(error^2)/length(error)mae=mean(abs(error)) mape=100*(mean(abs((error)/X.true)))##quadratic forecasttsq<-(ts^2)/factorial(2)fit2<-lm(X~ts+tsq)tsn<-t[year.first:year.last]tsnq<-(tsn^2)/factorial(2)mat<-cbind(tsn,tsnq)colnames(mat)<-c("ts","tsq")new2<-data.frame(mat)Xhat<-predict(fit2,new2,se.fit=TRUE)X.hat<-round(Xhat$fit,2)error<-X.true-X.hatme=mean(error)mpe=100*(mean(error/X.true)) mse=sum(error^2)/length(error)mae=mean(abs(error)) mape=100*(mean(abs((error)/X.true)))Problem 2Y=gtempt=time(gtemp)ts=t[21:118]Y2=Y[21:118]fit1=lm(Y2~ts)plot(ts,Y2,main="global temperature 1900-1997",type="l", xlab="Time (years)",ylab="temprature deviations")abline(fit1,col="red",lwd=2)summary(fit1)anova(fit1)## quadratictsq<-ts^2/factorial(2)fit2<-lm(Y2~ts+tsq)summary(fit2)anova(fit2)plot(Y2,type="o",xlab="Time(year)",ylab="temperature deviation",main="global temperature quadratic 1900-1997")par(new=T)plot(fit2$fitted,col="red",lwd=2,type="l",ylab="",xlab="",main="",xaxt="n",yaxt="n")n<-length(Y)aic1<-AIC(fit1)/nk<-2sse<-sum(resid(fit1)^2)aicc1<-log(sse/n)+((n+k)/(n-k-2))bic1<-(AIC(fit1,k=log(n)))/nn<-length(Y2)aic2<-AIC(fit2)/nk<-2sse<-sum(resid(fit2)^2)aicc2<-log(sse/n)+((n+k)/(n-k-2))bic2<-(AIC(fit2,k=log(n)))/nanova(fit1,fit2)Problem 3Winedata=read.table("Winedata.R")WinedataRed=Winedata$RedRose=Winedata$Rosex=Redn=length(x)par(mfrow=c(1,2))x.MA3<-filter(x,sides=2,rep(1,3)/3)resid.MA3=x[2:(n-1)]-x.MA3[2:(n-1)]plot.ts(x.MA3,main="3-Point MA Filter",xlab="Time(Year)", ylab="Red Wines Sales")plot.ts(resid.MA3, main="MA-3 Points Residual", ylab="Residual", xlab="Time")par(mfrow=c(1,2))x.MA5<-filter(x,sides=2,rep(1,5)/5)resid.MA5=x[2:(n-1)]-x.MA5[2:(n-1)]plot.ts(x.MA5,main="5-Point MA Filter",xlab="Time(Year)", ylab="Red Wines Sales")plot.ts(resid.MA5, main="MA-5 Points Residual", ylab="Residual", xlab="Time")par(mfrow=c(1,2))x.MA7<-filter(x,sides=2,rep(1,7)/7)resid.MA7=x[2:(n-1)]-x.MA7[2:(n-1)]plot.ts(x.MA7,main="7-Point MA Filter",xlab="Time(Year)", ylab="Red Wines Sales")plot.ts(resid.MA7, main="MA-7 Points Residual", ylab="Residual", xlab="Time")par(mfrow=c(1,2))x.MA9<-filter(x,sides=2,rep(1,9)/9)resid.MA9=x[2:(n-1)]-x.MA9[2:(n-1)]plot.ts(x.MA9,main="9-Point MA Filter",xlab="Time(Year)", ylab="Red Wines Sales")plot.ts(resid.MA9, main="MA-9 Points Residual", ylab="Residual", xlab="Time")